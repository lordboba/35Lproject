app = "REPLACE_WITH_FLY_APP_NAME"
primary_region = "iad"

[build]
builder = "heroku/buildpacks:20"
buildpacks = ["heroku/python"]

[env]
PORT = "8080"

[processes]
app = "python -m uvicorn server.main:app --host 0.0.0.0 --port 8080"

[[services]]
internal_port = 8080
processes = ["app"]
protocol = "tcp"
auto_stop_machines = "stop"
auto_start_machines = true
min_machines_running = 0

  [[services.ports]]
  handlers = ["http"]
  port = 80

  [[services.ports]]
  handlers = ["tls", "http"]
  port = 443

  [[services.tcp_checks]]
  interval = "15s"
  timeout = "2s"
  grace_period = "5s"
  restart_limit = 0
